# Ruby5 555

[Episode 555](https://ruby5.codeschool.com/episodes/597-episode-555-june-2nd-2015/stories/4726-make-your-own-rack-server)

## Make Your Own Rack Server

Rackサーバを自分で書いてSinatraアプリを動かす

[Make Your Own Rack Server](http://www.blrice.net/blog/2015/05/31/make-your-own-rack-server/)
[Rackサーバのコード](https://gist.github.com/nevern02/d2e9cca4c1fc6052acaa)

### Rackアプリとは

railsやsinatraなどのRubyでWebアプリを作る場合のインターフェース.
ステータス,ヘッダ,ボディの配列を返すcallメソッドを用意する.

````ruby:config.ru

class Foo
  def call(env)
    [200, {'Content-Type' => 'text/plain'}, ['Hello']]
  end
end

run Foo.new
````

[参考: Rack解説](http://qiita.com/higuma/items/838f4f58bc4a0645950a)

Rackハンドラでrackサーバの違いを吸収する

### サーバサイド

Rack::Handerの仕組みによってRackアプリケーションからサーバを指定できるようになる.

````
Rack::Hander.register 'server name', 'Rack::Handler::MyServer'
````

Rack::HandlerのクラスはRackアプリケーションを受け取るクラスメソッド`run`を実装し`run`の中でリクエストを受け付ける無限ループを実行する.

````
module Rack
  module Handler
    class MyServer
      self.run(app, opts)
        loop do
          ...
        end
      end
    end
  end
end
````

リクエストの受付は`TCPServer#accept`で受け取りRackアプリに渡す環境変数Hashを作成する.
Rackアプリの環境変数Hashの仕様は[ここ](http://www.rubydoc.info/github/rack/rack/master/file/SPEC)で定義されている.

````
socket = TCPServer.new host, port

loop do
  socket.accept
  request = socket.gets
  env = new_env *request.split
  status, headers, body = app.call env

  socket.print <<-HTML
HTTP/1.1 200 OK
Content-Type: text/html
Server: MyServer
Connection: close

<html><body>

...

</body></html>
  HTML

  socket.close
end
````

### 思うところ

Rackアプリを作ることはあってもサーバを作ることはないので実際にcallメソッドを呼び出している部分を見ると感動する.
`thin`とか`puma`とかもう怖くない？
RackHandlerのおかげで気軽にサーバを設定できるようになっている.


## Hash and default_proc

`Hash#default_proc`を利用することでコストの高いproc処理を遅延評価して効率化する.

[Hash and default_proc](http://thingsinabucket.com/2015/05/27/hash_default_proc/)

### Hashのおさらい

Hash.newに引数を渡すとキーがなかった場合の初期値になる.

````
a = {}
a[:hoge] # => nil

b = Hash.new
b[:hoge] # => nil

a.default = :some
a[:hoge] # => :some

c = Hash.new :some
c[:hoge] = :some
````

`Hash#default_proc=`にプロックを, `Hash.new`にブロックを渡すことでキーがなかった時に計算結果を返す.

````
a = {}
a.default_proc = ->(hash, key) {:fuga}
a[:piyo] # => :fuga

b = Hash.new do |hash, key|
  :some
end
b[:piyo] # => :some
````

計算結果をハッシュにキャッシュしたい場合に必要な時に初めて評価されれば効率がよくなる.
また, 一度ハッシュの値に格納することでメモ化もできる.

普通にやると一通り実行してしまう.

````
result = {}
some_collection.each do |key|
  acc[key] = expensive_proc key
end
result
````

`Hash#defult_proc`を利用する
````
result = Hash.new do |hash, key|
  hash[key] = expensive_proc key
end
````

### procの呼び出し方

````
a = ->(a, b) { puts [a, b].join ':'}
a.call 1, 2 # => 1:2
a.(1, 2) # => 1:2
a[1, 2] # => 1:2
````

### default_procを利用する

procの呼び出し方を`[]`にすることでHashによる計算結果のキャッシュが実現できる.

````
expensive_proc = ->(v) do
  puts "Expensive calculation"
  sleep 1
  [v] * 2
end

expensive_proc_with_cache = Hash.new do |hash, key|
  hash[key] = expensive_proc[key]
end

def repeat_10_times(proc)
  10.times do |i|
    proc[ i % 2 ]
  end
end

repeat_10_times(expensive_proc) # Takes about 10 seconds
repeat_10_times(expensive_proc_with_cache) # Takes about 2 seconds
````

余談として`Hash#default_proc`は`fetch`には適用されない.


## Enumerable#pluck

[railsのissue](https://github.com/rails/rails/pull/20350)

Rails5のActiveSupportにActiveRecordで利用できるのと同じように`pluck`がマージされた. 
最初は一つの項目のみだったが他のコミットで複数項目も可能になった.


## Ruby on Rails Book

[10 RoR books you must have on your bookshelf](https://netguru.co/blog/ruby-rails-books)

howじゃなくてwhyを書いてある本は普遍である.

### Eloquent Ruby

![Eloquent Ruby](http://d.gr-assets.com/books/1348111715l/9364729.jpg)

チュートリアル形式. 2011年発行.

### Clean Ruby

![Clean Ruby](http://d.gr-assets.com/books/1337967432l/14438307.jpg)

2013年発行？ワンラインコードなどに走らず保守しやすいコードをチュートリアル形式で教えてくれる.

### Well-Grounded Rubyist

![Well-Grounded Rubyist](http://www.manning.com/black2/black2_cover150.jpg)

2009年発行. 初心者から熟練プログラマーになる本.

### Ruby Science

![Ruby Science](https://static-2.gumroad.com/res/gumroad/3227386838752/asset_previews/777f794d39fc74c073d433d448de0761/default/Ruby_20Science.png)

初心者がアプリを作成する際のリファレンスになる.

### Confident Ruby

![Confident Ruby](http://www.confidentruby.com/confident-ruby-book.png)

Rubyのメソッドを実装する上で信頼性の高いコードにする秘訣を教えてくれる.

### Agile Web Development with Rails 4

![Agile Web Development with Rails 4](https://imagery.pragprog.com/products/196/rails4_xlargecover.jpg?1378493037)

Railsの入門書といったらこれ. railsのバージョンが異なるため最新の版を買うように注意しないといけない.
日本語版あり.

### Learn Ruby the Hard Way

![Learn Ruby the Hard Way](http://d.gr-assets.com/books/1412773736l/13418158.jpg)

一応[無料で読める](http://learnrubythehardway.org/book/)けど新しい版が出るらしい.
初心者から楽しめて問題を解いていくタイプの本.

### Why's Poignant Guide to Ruby

![Why's Poignant Guide to Ruby](http://mislav.uniqpath.com/poignant-guide/images/2006.cover.jpg)

whyが書いた[Rubyを紹介する絵本](http://mislav.uniqpath.com/poignant-guide/book/).

### Refactoring Ruby Edition

[Refactoring Ruby Edition](data:image/jpeg;base64,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)

リファクタリングのRuby版. 動的言語ならではのつまりどころに言及されているそうな.日本語版あり.

### Everyday Rails Testing with RSpec

![Everyday Rails](https://s3.amazonaws.com/titlepages.leanpub.com/everydayrailsrspec/large?1425523250)

Rails4.1 + RSpec3に対応. 日本語版あり.

